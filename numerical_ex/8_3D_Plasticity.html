
<!DOCTYPE html>


<html lang="en" data-content_root="../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>A triaxial experiment with Cam-clay yield criterion &#8212; PoreNum</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b76e3c8a" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9a2dae69"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../_static/copybutton.js?v=f281be69"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js?v=f930bc37"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'numerical_ex/8_3D_Plasticity';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/pore_num.png" class="logo__image only-light" alt="PoreNum - Home"/>
    <script>document.write(`<img src="../_static/pore_num.png" class="logo__image only-dark" alt="PoreNum - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    Welcome to PoreNum!
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../theory.html">Theory of poromechanics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../theory/thermodynamics.html">Thermodynamics of porous continua</a></li>
<li class="toctree-l2"><a class="reference internal" href="../theory/constitutive.html">Constitutive relationships of porous media</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../systems.html">Solving equation systems</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../systems/0_Warmup.html">A short introduction on solving equation systems numerically for poromechanics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../systems/1_Introduction.html">Introduction to Newtonâ€™s (Newton-Raphson) method</a></li>

<li class="toctree-l2"><a class="reference internal" href="../systems/2_MultivariateNewton.html">Multivariate Newton method</a></li>
<li class="toctree-l2"><a class="reference internal" href="../systems/3_SimpleNonlinearSystem.html">Thermal pressurization in an undrained porous solid</a></li>
<li class="toctree-l2"><a class="reference internal" href="../systems/4_ImplicitSchemes.html">Numerical integration of differential equations : Explicit and implicit schemes</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../numerical_ex.html">Numerical implementation in poromechanics</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="5_HardeningPlasticity.html">A simple istropic hardening plasticity algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="6_1D_Poroplasticity.html">Coupled plasticity example: Thermal softening of a poroplastic solid</a></li>
<li class="toctree-l2"><a class="reference internal" href="7_VectorTensorNotations.html">Vector notations for tensors for easy implementation of tensor algebra</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/executablebooks/jupyter-book/issues/new?title=Issue%20on%20page%20%2Fnumerical_ex/8_3D_Plasticity.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/numerical_ex/8_3D_Plasticity.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>A triaxial experiment with Cam-clay yield criterion</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stress-strain-hybrid-control">Stress - strain hybrid control</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="a-triaxial-experiment-with-cam-clay-yield-criterion">
<h1>A triaxial experiment with Cam-clay yield criterion<a class="headerlink" href="#a-triaxial-experiment-with-cam-clay-yield-criterion" title="Link to this heading">#</a></h1>
<p>In this notebook, we will simulate a triaxial experiment in hardening plasticity with a Cam-clay yield criterion. In contrast to the previous 1D example, now some variables will be tensorial while others will be scalar. We will see, however, that this is in practice of little importance from an implementation point of view. <br />
We will start by re-using the previous <strong>Mandel</strong> notation for tensors: 2nd order tensors will become vectors and 4th order tensors will become matrices. The main novelty from 1D resides in the yield criterion and flow rule, which are much more complex to calculte than in the 1D case. <br />
The Cam-clay yield criterion reads:</p>
<div class="math notranslate nohighlight">
\[
f(p,q) = q^2 + M^2(p+p_t)(p-p_c),
\]</div>
<p>where <span class="math notranslate nohighlight">\(p=\frac{1}{3}\mathrm{tr}({\bf \sigma})\)</span> is the mean stress and <span class="math notranslate nohighlight">\(q=\sqrt{\frac{3}{2}{\bf \sigma}^d:{\bf \sigma}^d}\)</span> is the <em>Von Mises</em> stress of the <em>deviatoric stress</em> tensor <span class="math notranslate nohighlight">\({\bf \sigma}^d\)</span>. <br />
Recalling that if <span class="math notranslate nohighlight">\(\bf T\)</span> is a second order tensor and <span class="math notranslate nohighlight">\(\bf \tilde{T}\)</span> itâ€™s Mandel notation, then <span class="math notranslate nohighlight">\({\bf T}:{\bf T} = {\bf\tilde{T}}\cdot{\bf\tilde{T}}\)</span>, let us implement the yield criterion in the Mandel notation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Utilities to translate to/from Mandel notation for 2nd order symmetric tensors</span>
<span class="k">def</span> <span class="nf">mandel_to_tensor2</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">T</span><span class="o">.</span><span class="n">shape</span><span class="o">==</span><span class="p">(</span><span class="mi">6</span><span class="p">,)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">T</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">T</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span>
                     <span class="p">[</span><span class="n">T</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">T</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)],</span>
                     <span class="p">[</span><span class="n">T</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">T</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">]]])</span>
    
<span class="k">def</span> <span class="nf">tensor2_to_mandel</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">T</span><span class="o">.</span><span class="n">shape</span><span class="o">==</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
    <span class="k">assert</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span><span class="o">==</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="ow">and</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">==</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span> <span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]])</span>

<span class="k">def</span> <span class="nf">lame</span><span class="p">(</span><span class="n">E</span><span class="p">,</span> <span class="n">nu</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">E</span><span class="o">*</span><span class="n">nu</span><span class="o">/</span><span class="p">((</span><span class="mi">1</span><span class="o">+</span><span class="n">nu</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="mi">1</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">nu</span><span class="p">)),</span> <span class="n">E</span><span class="o">/</span><span class="mi">2</span><span class="o">/</span><span class="p">(</span><span class="mi">1</span><span class="o">+</span><span class="n">nu</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">stiffness_tensor</span><span class="p">(</span><span class="n">lam</span><span class="p">,</span> <span class="n">mu</span><span class="p">):</span>
    <span class="n">D</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">3</span><span class="p">):</span>
            <span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">]</span><span class="o">+=</span><span class="n">lam</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">6</span><span class="p">):</span>
        <span class="n">D</span><span class="p">[</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="o">+=</span><span class="mi">2</span><span class="o">*</span><span class="n">mu</span>
    <span class="k">return</span> <span class="n">D</span>

<span class="c1"># Second order identity tensor in Mandel notation</span>
<span class="n">I2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span> 

<span class="c1"># Trace and Deviator function</span>
<span class="k">def</span> <span class="nf">tr</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">T</span><span class="o">.</span><span class="n">shape</span><span class="o">==</span><span class="p">(</span><span class="mi">6</span><span class="p">,)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">T</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">])</span>
    
<span class="k">def</span> <span class="nf">dev</span><span class="p">(</span><span class="n">T</span><span class="p">):</span>
    <span class="k">assert</span> <span class="n">T</span><span class="o">.</span><span class="n">shape</span><span class="o">==</span><span class="p">(</span><span class="mi">6</span><span class="p">,)</span>
    <span class="k">return</span> <span class="n">T</span> <span class="o">-</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">tr</span><span class="p">(</span><span class="n">T</span><span class="p">)</span><span class="o">*</span><span class="n">I2</span>

<span class="k">def</span> <span class="nf">yield_function</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span> <span class="c1">#Sigma in mandel notation</span>
    <span class="n">p</span> <span class="o">=</span> <span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="n">tr</span><span class="p">(</span><span class="n">sigma</span><span class="p">)</span>
    <span class="n">sig_d</span> <span class="o">=</span> <span class="n">dev</span><span class="p">(</span><span class="n">sigma</span><span class="p">)</span>
    <span class="n">q</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">sig_d</span><span class="p">,</span> <span class="n">sig_d</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">q</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">M</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="p">(</span><span class="n">p</span><span class="o">+</span><span class="n">pt</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">p</span><span class="o">-</span><span class="n">pc</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now is the flow rule. If we take associated plasticity, the plastic potential is equal to the yield criterion (<span class="math notranslate nohighlight">\(g=f\)</span>), and the flow rule is:</p>
<div class="math notranslate nohighlight">
\[
{\bf \dot\varepsilon}_p = \dot\lambda \frac{\partial g}{\partial{\bf\sigma}},
\]</div>
<p>where the scalar <span class="math notranslate nohighlight">\(\lambda\)</span> is the plastic multiplier. The tensor <span class="math notranslate nohighlight">\({\bf n} = \frac{\partial g}{\partial{\bf\sigma}}\)</span> representing the direction of plastic flow is not an easy one to calculate. We will decompose it as such:</p>
<div class="math notranslate nohighlight">
\[
\frac{\partial g}{\partial{\bf\sigma}} = \frac{\partial g}{\partial p}\frac{\partial p}{\partial{\bf\sigma}} + \frac{\partial g}{\partial q}\frac{\partial q}{\partial{\bf\sigma}}.
\]</div>
<p>Partial derivatives with respect to <span class="math notranslate nohighlight">\(p\)</span> and <span class="math notranslate nohighlight">\(q\)</span> are fairly trivial:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{align}
\frac{\partial g}{\partial p} &amp;= M^2  (2p + p_t -p_c), \\
\frac{\partial g}{\partial q} &amp;= 2q,
\end{align}
\end{split}\]</div>
<p>but the other two partial derivatives require derivation with respect to a tensor variable. <span class="math notranslate nohighlight">\(\partial h/\partial {\bf T}\)</span> is in general the tensor <span class="math notranslate nohighlight">\(\bf S\)</span> so that <span class="math notranslate nohighlight">\(\mathrm{d}h = {\bf S}:\mathrm{d}{\bf T}\)</span> (other variables being kept constant). We have:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
\begin{array}
\mathrm{d}p = \frac{1}{3}(\mathrm{d}\sigma_{11}+\mathrm{d}\sigma_{22}+\mathrm{d}\sigma_{33}) = \frac{1}{3}{\bf I}_2:\mathrm{d}{\bf \sigma} \ \rightarrow \ \frac{\partial p}{\partial{\bf\sigma}} = \frac{1}{3}{\bf I}_2,\\
\frac{\partial q}{\partial{\bf\sigma}} = \frac{\partial}{\partial{\bf\sigma}}\left( \sqrt{\frac{3}{2}{\bf\sigma}^d:{\bf\sigma}^d}\right) = \frac{6{\bf\sigma}^d}{4\sqrt{\frac{3}{2}{\bf\sigma}^d:{\bf\sigma}^d}} = \frac{3{\bf\sigma}^d}{2q}.
\end{array}
\end{split}\]</div>
<p>In fine, the plastic flow direction is:</p>
<div class="math notranslate nohighlight">
\[
{\bf n} = \frac{M^2}{3}(2p + p_t -p_c){\bf I}_2 + 3{\bf\sigma}^d.
\]</div>
<p>Let us implement it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Function which returns the plastic flow direction tensor n</span>
<span class="k">def</span> <span class="nf">flow_direction</span><span class="p">(</span><span class="n">sigma</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">pt</span><span class="p">,</span> <span class="n">M</span><span class="p">):</span>
    <span class="n">p</span> <span class="o">=</span> <span class="n">tr</span><span class="p">(</span><span class="n">sigma</span><span class="p">)</span><span class="o">/</span><span class="mf">3.0</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">M</span><span class="o">**</span><span class="mi">2</span><span class="o">/</span><span class="mi">3</span><span class="o">*</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">p</span><span class="o">+</span><span class="n">pt</span><span class="o">-</span><span class="n">pc</span><span class="p">)</span><span class="o">*</span><span class="n">I2</span> <span class="o">+</span> <span class="mi">3</span><span class="o">*</span><span class="n">dev</span><span class="p">(</span><span class="n">sigma</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">n</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">n</span><span class="p">,</span><span class="n">n</span><span class="p">))</span> <span class="c1"># normalized n tensor</span>
</pre></div>
</div>
</div>
</div>
<p>We now have to implement the plasticity return mapping, namely the equation system <span class="math notranslate nohighlight">\(\bf F\)</span> as well as the jacobian <span class="math notranslate nohighlight">\(\bf J\)</span>. The jacobian can be calculated analytically but is tedious to obtain: we will make use here of a numerical jacobian.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Implicit system</span>
<span class="k">def</span> <span class="nf">F</span><span class="p">(</span><span class="n">dX</span><span class="p">,</span> <span class="n">sig_n</span><span class="p">,</span> <span class="n">rpc_n</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">ft</span><span class="p">,</span> <span class="n">deps</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span>
    <span class="n">deps_el</span> <span class="o">=</span> <span class="n">dX</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">dlam</span> <span class="o">=</span> <span class="n">dX</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
    <span class="n">drpc</span> <span class="o">=</span> <span class="n">dX</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
    <span class="n">sig_</span> <span class="o">=</span> <span class="n">sig_n</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">deps_el</span><span class="p">)</span>
    <span class="n">rpc_</span> <span class="o">=</span> <span class="n">rpc_n</span> <span class="o">+</span> <span class="n">drpc</span>
    <span class="n">pc_</span> <span class="o">=</span> <span class="n">E</span> <span class="o">*</span> <span class="n">rpc_</span>
    <span class="n">pt_</span> <span class="o">=</span> <span class="n">ft</span><span class="o">*</span><span class="n">pc_</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">flow_direction</span><span class="p">(</span><span class="n">sig_</span><span class="p">,</span> <span class="n">pc_</span><span class="p">,</span> <span class="n">pt_</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">*</span><span class="p">(</span><span class="n">deps_el</span> <span class="o">+</span> <span class="n">dlam</span><span class="o">*</span><span class="n">n</span> <span class="o">-</span> <span class="n">deps</span><span class="p">),</span>
                     <span class="n">yield_function</span><span class="p">(</span><span class="n">sig_</span><span class="p">,</span> <span class="n">pc_</span><span class="p">,</span> <span class="n">pt_</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span><span class="o">/</span><span class="n">E</span><span class="o">/</span><span class="n">pc0</span><span class="p">,</span>
                     <span class="p">(</span><span class="n">drpc</span> <span class="o">+</span> <span class="n">h</span><span class="o">*</span><span class="n">dlam</span><span class="o">*</span><span class="n">tr</span><span class="p">(</span><span class="n">n</span><span class="p">)</span><span class="o">*</span><span class="n">rpc_</span><span class="p">)])</span>

<span class="c1"># Numerical jacobian</span>
<span class="k">def</span> <span class="nf">numerical_J</span><span class="p">(</span><span class="n">dX</span><span class="p">,</span> <span class="n">residu</span><span class="p">,</span> <span class="n">perturbation</span><span class="p">):</span>
    <span class="n">perturbator</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">perturbation</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">dX</span><span class="p">)))</span>
    <span class="k">return</span> <span class="mi">1</span><span class="o">/</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">perturbation</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">residu</span><span class="p">(</span><span class="n">dX</span> <span class="o">+</span> <span class="n">eps</span><span class="p">)</span><span class="o">-</span><span class="n">residu</span><span class="p">(</span><span class="n">dX</span> <span class="o">-</span> <span class="n">eps</span><span class="p">)</span> <span class="k">for</span> <span class="n">eps</span> <span class="ow">in</span> <span class="n">perturbator</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>

<span class="k">def</span> <span class="nf">newton_method</span><span class="p">(</span><span class="n">residu</span><span class="p">,</span> <span class="n">jacobian</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">,</span> <span class="n">tolerance</span><span class="p">,</span> <span class="n">max_iteration</span><span class="o">=</span><span class="mi">50</span><span class="p">):</span>
    <span class="n">X_n</span> <span class="o">=</span> <span class="n">initial_guess</span>
    <span class="n">iteration</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">residu</span><span class="p">(</span><span class="n">X_n</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">tolerance</span> <span class="ow">and</span> <span class="n">iteration</span> <span class="o">&lt;</span> <span class="n">max_iteration</span><span class="p">:</span>
        <span class="n">X_n</span> <span class="o">-=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">jacobian</span><span class="p">(</span><span class="n">X_n</span><span class="p">)),</span> <span class="n">residu</span><span class="p">(</span><span class="n">X_n</span><span class="p">))</span>
        <span class="n">iteration</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">residu</span><span class="p">(</span><span class="n">X_n</span><span class="p">))</span> <span class="o">&gt;</span> <span class="n">tolerance</span><span class="p">:</span>  <span class="c1"># Not converged</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Did not converge after </span><span class="si">{}</span><span class="s2"> iterations.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">iteration</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Newton solver: converged after </span><span class="si">{}</span><span class="s2"> iterations.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">iteration</span><span class="p">))</span>   
    <span class="k">return</span> <span class="n">X_n</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Material properties</span>
<span class="n">E</span> <span class="o">=</span> <span class="mf">1e10</span>
<span class="n">nu</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="n">pc0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1e6</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">3000.0</span>
<span class="n">ft</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">M</span> <span class="o">=</span> <span class="mi">1</span>

<span class="n">C</span> <span class="o">=</span> <span class="n">stiffness_tensor</span><span class="p">(</span><span class="o">*</span><span class="n">lame</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">nu</span><span class="p">))</span>

<span class="c1"># Load step</span>
<span class="n">deps</span> <span class="o">=</span> <span class="n">tensor2_to_mandel</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="o">-</span><span class="mf">1e-6</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">3</span><span class="p">)))</span>

<span class="c1"># Initial values</span>
<span class="n">eps</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
<span class="n">eps_el</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
<span class="n">sig</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
<span class="n">lam</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span>
<span class="n">pc</span> <span class="o">=</span> <span class="p">[</span><span class="n">pc0</span><span class="p">]</span>

<span class="k">def</span> <span class="nf">integrator</span><span class="p">(</span><span class="n">eps</span><span class="p">,</span> <span class="n">deps</span><span class="p">,</span> <span class="n">eps_el</span><span class="p">,</span> <span class="n">lam</span><span class="p">,</span> <span class="n">pc</span><span class="p">):</span>
    <span class="n">eps</span> <span class="o">+=</span> <span class="n">deps</span>
    <span class="n">sig_trial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">eps</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">yield_function</span><span class="p">(</span><span class="n">sig_trial</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">ft</span><span class="o">*</span><span class="n">pc</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">eps_el</span> <span class="o">+=</span> <span class="n">deps</span>
        <span class="k">return</span> <span class="n">eps</span><span class="p">,</span> <span class="n">eps_el</span><span class="p">,</span> <span class="n">lam</span><span class="p">,</span> <span class="n">pc</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">X</span> <span class="p">:</span> <span class="n">F</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">eps_el</span><span class="p">),</span> <span class="n">pc</span><span class="o">/</span><span class="n">E</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">ft</span><span class="p">,</span> <span class="n">deps</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
        <span class="n">dX</span> <span class="o">=</span> <span class="n">newton_method</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">X</span> <span class="p">:</span> <span class="n">numerical_J</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="mf">1e-9</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="mf">1e-6</span><span class="p">)</span>
        <span class="n">deps_el</span> <span class="o">=</span> <span class="n">dX</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">dlam</span> <span class="o">=</span> <span class="n">dX</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span>
        <span class="n">dpc</span> <span class="o">=</span> <span class="n">E</span><span class="o">*</span><span class="n">dX</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">eps</span><span class="p">,</span> <span class="n">eps_el</span><span class="o">+</span><span class="n">deps_el</span><span class="p">,</span> <span class="n">lam</span><span class="o">+</span><span class="n">dlam</span><span class="p">,</span> <span class="n">pc</span><span class="o">+</span><span class="n">dpc</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Load step&quot;</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">eps_</span><span class="p">,</span> <span class="n">eps_el_</span><span class="p">,</span> <span class="n">lam_</span><span class="p">,</span> <span class="n">pc_</span> <span class="o">=</span> <span class="n">integrator</span><span class="p">(</span><span class="n">eps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">deps</span><span class="p">,</span> <span class="n">eps_el</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">lam</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">pc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">eps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eps_</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
    <span class="n">eps_el</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eps_el_</span><span class="p">)</span>
    <span class="n">lam</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lam_</span><span class="p">)</span>
    <span class="n">pc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pc_</span><span class="p">)</span>
    <span class="n">sig</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">eps_el_</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Load step 1
Load step 2
Load step 3
Load step 4
Load step 5
Load step 6
Load step 7
Load step 8
Load step 9
Load step 10
Load step 11
Load step 12
Load step 13
Load step 14
Load step 15
Load step 16
Load step 17
Load step 18
Load step 19
Load step 20
Load step 21
Load step 22
Load step 23
Load step 24
Load step 25
Load step 26
Load step 27
Load step 28
Load step 29
Load step 30
Load step 31
Load step 32
Load step 33
Load step 34
Load step 35
Load step 36
Load step 37
Load step 38
Load step 39
Load step 40
Load step 41
Load step 42
Load step 43
Load step 44
Load step 45
Load step 46
Load step 47
Load step 48
Load step 49
Load step 50
Load step 51
Load step 52
Load step 53
Load step 54
Load step 55
Load step 56
Load step 57
Load step 58
Load step 59
Load step 60
Load step 61
Newton solver: converged after 1 iterations.
Load step 62
Newton solver: converged after 1 iterations.
Load step 63
Newton solver: converged after 1 iterations.
Load step 64
Newton solver: converged after 1 iterations.
Load step 65
Newton solver: converged after 1 iterations.
Load step 66
Newton solver: converged after 1 iterations.
Load step 67
Newton solver: converged after 1 iterations.
Load step 68
Newton solver: converged after 1 iterations.
Load step 69
Newton solver: converged after 1 iterations.
Load step 70
Newton solver: converged after 1 iterations.
Load step 71
Newton solver: converged after 1 iterations.
Load step 72
Newton solver: converged after 1 iterations.
Load step 73
Newton solver: converged after 1 iterations.
Load step 74
Newton solver: converged after 1 iterations.
Load step 75
Newton solver: converged after 1 iterations.
Load step 76
Newton solver: converged after 1 iterations.
Load step 77
Newton solver: converged after 1 iterations.
Load step 78
Newton solver: converged after 1 iterations.
Load step 79
Newton solver: converged after 1 iterations.
Load step 80
Newton solver: converged after 1 iterations.
Load step 81
Newton solver: converged after 1 iterations.
Load step 82
Newton solver: converged after 1 iterations.
Load step 83
Newton solver: converged after 1 iterations.
Load step 84
Newton solver: converged after 1 iterations.
Load step 85
Newton solver: converged after 1 iterations.
Load step 86
Newton solver: converged after 1 iterations.
Load step 87
Newton solver: converged after 1 iterations.
Load step 88
Newton solver: converged after 1 iterations.
Load step 89
Newton solver: converged after 1 iterations.
Load step 90
Newton solver: converged after 1 iterations.
Load step 91
Newton solver: converged after 1 iterations.
Load step 92
Newton solver: converged after 1 iterations.
Load step 93
Newton solver: converged after 1 iterations.
Load step 94
Newton solver: converged after 1 iterations.
Load step 95
Newton solver: converged after 1 iterations.
Load step 96
Newton solver: converged after 1 iterations.
Load step 97
Newton solver: converged after 1 iterations.
Load step 98
Newton solver: converged after 1 iterations.
Load step 99
Newton solver: converged after 1 iterations.
Load step 100
Newton solver: converged after 1 iterations.
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">tr</span><span class="p">(</span><span class="n">sigma</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span> <span class="k">for</span> <span class="n">sigma</span> <span class="ow">in</span> <span class="n">sig</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dev</span><span class="p">(</span><span class="n">sigma</span><span class="p">),</span> <span class="n">dev</span><span class="p">(</span><span class="n">sigma</span><span class="p">)))</span> <span class="k">for</span> <span class="n">sigma</span> <span class="ow">in</span> <span class="n">sig</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">yield_surf</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">ft</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">M</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">p</span><span class="o">+</span><span class="n">ft</span><span class="o">*</span><span class="n">pc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">pc</span><span class="o">-</span><span class="n">p</span><span class="p">))</span>
<span class="k">for</span> <span class="n">pc_</span> <span class="ow">in</span> <span class="n">pc</span><span class="p">:</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pc_</span><span class="p">,</span> <span class="o">-</span><span class="n">ft</span><span class="o">*</span><span class="n">pc_</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">p</span> <span class="p">:</span> <span class="n">yield_surf</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">pc_</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">ft</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="p">[</span><span class="n">ys</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">P</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/eda5f984213e88003e50cb294625113d67fb26b9a99b55428805c1500b8eb76b.png" src="../_images/eda5f984213e88003e50cb294625113d67fb26b9a99b55428805c1500b8eb76b.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eps1</span> <span class="o">=</span> <span class="n">eps</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">eps_el1</span> <span class="o">=</span> <span class="n">eps_el</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">sig1</span> <span class="o">=</span> <span class="n">sig</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="stress-strain-hybrid-control">
<h2>Stress - strain hybrid control<a class="headerlink" href="#stress-strain-hybrid-control" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Material properties</span>
<span class="n">E</span> <span class="o">=</span> <span class="mf">1.5e11</span>
<span class="n">nu</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">pc0</span> <span class="o">=</span> <span class="o">-</span><span class="mf">30e6</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">250.0</span>
<span class="n">ft</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">M</span> <span class="o">=</span> <span class="mf">1.5</span>

<span class="n">C</span> <span class="o">=</span> <span class="n">stiffness_tensor</span><span class="p">(</span><span class="o">*</span><span class="n">lame</span><span class="p">(</span><span class="n">E</span><span class="p">,</span><span class="n">nu</span><span class="p">))</span>

<span class="c1"># Load step</span>
<span class="n">deps_all</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">),</span> <span class="o">*</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="mf">0.0</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">*</span><span class="mf">2e-5</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]]</span>
<span class="c1">#deps_all = [ np.zeros(6) for i in range(100) ]</span>
<span class="c1">#dsig_all = np.diff(sig, axis=0).copy()</span>
<span class="n">dsig_all</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">7.5e6</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.5e6</span><span class="p">,</span> <span class="o">-</span><span class="mf">7.5e6</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">]),</span> <span class="o">*</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]]</span>

<span class="n">sig_tol</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">dsig_all</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">/</span><span class="mf">1e8</span><span class="p">)</span>

<span class="c1"># Initial values</span>
<span class="n">eps</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
<span class="n">eps_el</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
<span class="n">sig</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">6</span><span class="p">)]</span>
<span class="n">lam</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span>
<span class="n">pc</span> <span class="o">=</span> <span class="p">[</span><span class="n">pc0</span><span class="p">]</span>

<span class="n">I4</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diag</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">6</span><span class="p">))</span>

<span class="k">def</span> <span class="nf">integrator_with_tangent</span><span class="p">(</span><span class="n">eps</span><span class="p">,</span> <span class="n">deps</span><span class="p">,</span> <span class="n">eps_el</span><span class="p">,</span> <span class="n">lam</span><span class="p">,</span> <span class="n">pc</span><span class="p">):</span>
    <span class="n">eps</span> <span class="o">+=</span> <span class="n">deps</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">sig_trial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">eps</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">yield_function</span><span class="p">(</span><span class="n">sig_trial</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">ft</span><span class="o">*</span><span class="n">pc</span><span class="p">,</span> <span class="n">M</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">eps_el</span> <span class="o">+=</span> <span class="n">deps</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">eps</span><span class="p">,</span> <span class="n">eps_el</span><span class="p">,</span> <span class="n">lam</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">C</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">f</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">X</span> <span class="p">:</span> <span class="n">F</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">eps_el</span><span class="p">),</span> <span class="n">pc</span><span class="o">/</span><span class="n">E</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">ft</span><span class="p">,</span> <span class="n">deps</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>
        <span class="n">dX</span> <span class="o">=</span> <span class="n">newton_method</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">X</span> <span class="p">:</span> <span class="n">numerical_J</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="mf">1e-10</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">8</span><span class="p">),</span> <span class="mf">1e-15</span><span class="p">)</span>
        <span class="n">deps_el</span> <span class="o">=</span> <span class="n">dX</span><span class="p">[:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">dlam</span> <span class="o">=</span> <span class="n">dX</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">dpc</span> <span class="o">=</span> <span class="n">E</span><span class="o">*</span><span class="n">dX</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">jacobian</span> <span class="o">=</span> <span class="n">numerical_J</span><span class="p">(</span><span class="n">dX</span><span class="p">,</span> <span class="k">lambda</span> <span class="n">X</span> <span class="p">:</span> <span class="n">F</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">eps_el</span><span class="o">+</span><span class="n">deps_el</span><span class="p">),</span> <span class="p">(</span><span class="n">pc</span><span class="o">+</span><span class="n">dpc</span><span class="p">)</span><span class="o">/</span><span class="n">E</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">ft</span><span class="p">,</span> <span class="n">deps</span><span class="p">,</span> <span class="n">C</span><span class="p">,</span> <span class="n">h</span><span class="p">),</span> <span class="mf">1e-10</span><span class="p">)</span>
        <span class="n">j_inv_eps_el</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">jacobian</span><span class="p">)[:</span><span class="mi">6</span><span class="p">,:</span><span class="mi">6</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">dsig_ddeps</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span> <span class="n">C</span><span class="p">,</span> <span class="n">j_inv_eps_el</span> <span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">eps</span><span class="p">,</span> <span class="n">eps_el</span><span class="o">+</span><span class="n">deps_el</span><span class="p">,</span> <span class="n">lam</span><span class="o">+</span><span class="n">dlam</span><span class="p">,</span> <span class="n">pc</span><span class="o">+</span><span class="n">dpc</span><span class="p">,</span> <span class="n">dsig_ddeps</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">deps_all</span><span class="p">)):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Load step&quot;</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">sig_</span> <span class="o">=</span> <span class="n">sig</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">sig_goal</span> <span class="o">=</span> <span class="n">sig_</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="o">+</span> <span class="n">dsig_all</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">deps</span> <span class="o">=</span> <span class="n">deps_all</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">eps_</span><span class="p">,</span> <span class="n">eps_el_</span><span class="p">,</span> <span class="n">lam_</span><span class="p">,</span> <span class="n">pc_</span><span class="p">,</span> <span class="n">dsig_ddeps</span> <span class="o">=</span> <span class="n">integrator_with_tangent</span><span class="p">(</span><span class="n">eps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">deps</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">eps_el</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">lam</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">pc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
    <span class="n">sig_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">eps_el_</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="c1">#print(&quot;deps:&quot;,deps)</span>
    <span class="n">j</span><span class="o">=</span><span class="mi">0</span>
    <span class="k">while</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">sig_goal</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span><span class="o">-</span><span class="n">sig_</span><span class="p">[:</span><span class="mi">3</span><span class="p">])</span> <span class="o">&gt;</span> <span class="mf">1e-3</span><span class="p">:</span>
        <span class="n">j</span><span class="o">+=</span><span class="mi">1</span>
        <span class="n">eps_</span><span class="p">,</span> <span class="n">eps_el_</span><span class="p">,</span> <span class="n">lam_</span><span class="p">,</span> <span class="n">pc_</span><span class="p">,</span> <span class="n">dsig_ddeps</span> <span class="o">=</span> <span class="n">integrator_with_tangent</span><span class="p">(</span><span class="n">eps</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">deps</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">eps_el</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">copy</span><span class="p">(),</span> <span class="n">lam</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">pc</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">sig_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">C</span><span class="p">,</span> <span class="n">eps_el_</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="c1">#print(i,&quot;sig_:&quot;,sig_)</span>
        <span class="c1">#print(i,&quot;sig_goal:&quot;,sig_goal)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s2">&quot;C:&quot;</span><span class="p">,</span><span class="n">C</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s2">&quot;dsig_ddeps:&quot;</span><span class="p">,</span> <span class="n">dsig_ddeps</span><span class="p">)</span>
        <span class="n">deps</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">inv</span><span class="p">(</span><span class="n">dsig_ddeps</span><span class="p">)[:</span><span class="mi">3</span><span class="p">,:</span><span class="mi">3</span><span class="p">],(</span><span class="n">sig_goal</span><span class="o">-</span><span class="n">sig_</span><span class="p">)[:</span><span class="mi">3</span><span class="p">])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="c1">#print(&quot;Current epsilon&quot;)</span>
        <span class="c1">#print( eps[-1]+deps )</span>
        <span class="c1">#print(&quot;deps:&quot;,deps)</span>
        <span class="k">if</span> <span class="n">j</span><span class="o">&gt;</span><span class="mi">30</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Too many iterations&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s2">&quot;sig_:&quot;</span><span class="p">,</span> <span class="n">sig_</span><span class="p">)</span>
    <span class="n">eps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eps_</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
    <span class="n">eps_el</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eps_el_</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
    <span class="n">lam</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lam_</span><span class="p">)</span>
    <span class="n">pc</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">pc_</span><span class="p">)</span>
    <span class="n">sig</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">C</span><span class="p">,</span><span class="n">eps_el_</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Load step 1
0 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
0 dsig_ddeps: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
0 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
0 dsig_ddeps: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
0 sig_: [-7500000. -7500000. -7500000.        0.        0.        0.]
Load step 2
1 sig_: [-7500000.         -7500000.         -7500000.                0.
        0.          3263569.75932253]
Load step 3
2 sig_: [-7500000.         -7500000.         -7500000.                0.
        0.          6527139.51864506]
Load step 4
3 sig_: [-7500000.         -7500000.         -7500000.                0.
        0.          9790709.27796758]
Load step 5
4 sig_: [-7500000.         -7500000.         -7500000.                0.
        0.         13054279.03729011]
Load step 6
5 sig_: [-7500000.         -7500000.         -7500000.                0.
        0.         16317848.79661264]
Load step 7
Newton solver: converged after 4 iterations.
Newton solver: converged after 4 iterations.
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[ 1.78478773e+11  6.63691575e+10  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  1.78478773e+11  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  6.63691575e+10  1.78478773e+11  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.12109616e+11
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.12109616e+11  0.00000000e+00]
 [-3.93141420e+10 -3.93141420e+10 -3.93141420e+10  0.00000000e+00
   0.00000000e+00  1.35244210e+10]]
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
Newton solver: converged after 4 iterations.
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[ 1.78478773e+11  6.63691575e+10  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  1.78478773e+11  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  6.63691575e+10  1.78478773e+11  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.12109616e+11
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.12109616e+11  0.00000000e+00]
 [-3.93141420e+10 -3.93141420e+10 -3.93141420e+10  0.00000000e+00
   0.00000000e+00  1.35244210e+10]]
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
Newton solver: converged after 4 iterations.
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[ 1.78478773e+11  6.63691575e+10  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  1.78478773e+11  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  6.63691575e+10  1.78478773e+11  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.12109616e+11
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.12109616e+11  0.00000000e+00]
 [-3.93141420e+10 -3.93141420e+10 -3.93141420e+10  0.00000000e+00
   0.00000000e+00  1.35244210e+10]]
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
Newton solver: converged after 4 iterations.
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[ 1.78478773e+11  6.63691575e+10  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  1.78478773e+11  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  6.63691575e+10  1.78478773e+11  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.12109616e+11
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.12109616e+11  0.00000000e+00]
 [-3.93141420e+10 -3.93141420e+10 -3.93141420e+10  0.00000000e+00
   0.00000000e+00  1.35244210e+10]]
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
Newton solver: converged after 4 iterations.
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[ 1.78478773e+11  6.63691575e+10  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  1.78478773e+11  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  6.63691575e+10  1.78478773e+11  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.12109616e+11
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.12109616e+11  0.00000000e+00]
 [-3.93141420e+10 -3.93141420e+10 -3.93141420e+10  0.00000000e+00
   0.00000000e+00  1.35244210e+10]]
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
Newton solver: converged after 4 iterations.
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[ 1.78478773e+11  6.63691575e+10  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  1.78478773e+11  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  6.63691575e+10  1.78478773e+11  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.12109616e+11
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.12109616e+11  0.00000000e+00]
 [-3.93141420e+10 -3.93141420e+10 -3.93141420e+10  0.00000000e+00
   0.00000000e+00  1.35244210e+10]]
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
Newton solver: converged after 4 iterations.
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[ 1.78478773e+11  6.63691575e+10  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  1.78478773e+11  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  6.63691575e+10  1.78478773e+11  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.12109616e+11
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.12109616e+11  0.00000000e+00]
 [-3.93141420e+10 -3.93141420e+10 -3.93141420e+10  0.00000000e+00
   0.00000000e+00  1.35244210e+10]]
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
Newton solver: converged after 4 iterations.
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[ 1.78478773e+11  6.63691575e+10  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  1.78478773e+11  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  6.63691575e+10  1.78478773e+11  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.12109616e+11
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.12109616e+11  0.00000000e+00]
 [-3.93141420e+10 -3.93141420e+10 -3.93141420e+10  0.00000000e+00
   0.00000000e+00  1.35244210e+10]]
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
Newton solver: converged after 4 iterations.
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[ 1.78478773e+11  6.63691575e+10  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  1.78478773e+11  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  6.63691575e+10  1.78478773e+11  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.12109616e+11
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.12109616e+11  0.00000000e+00]
 [-3.93141420e+10 -3.93141420e+10 -3.93141420e+10  0.00000000e+00
   0.00000000e+00  1.35244210e+10]]
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
Newton solver: converged after 4 iterations.
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[ 1.78478773e+11  6.63691575e+10  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  1.78478773e+11  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  6.63691575e+10  1.78478773e+11  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.12109616e+11
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.12109616e+11  0.00000000e+00]
 [-3.93141420e+10 -3.93141420e+10 -3.93141420e+10  0.00000000e+00
   0.00000000e+00  1.35244210e+10]]
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
Newton solver: converged after 4 iterations.
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[ 1.78478773e+11  6.63691575e+10  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  1.78478773e+11  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  6.63691575e+10  1.78478773e+11  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.12109616e+11
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.12109616e+11  0.00000000e+00]
 [-3.93141420e+10 -3.93141420e+10 -3.93141420e+10  0.00000000e+00
   0.00000000e+00  1.35244210e+10]]
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
Newton solver: converged after 4 iterations.
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[ 1.78478773e+11  6.63691575e+10  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  1.78478773e+11  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  6.63691575e+10  1.78478773e+11  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.12109616e+11
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.12109616e+11  0.00000000e+00]
 [-3.93141420e+10 -3.93141420e+10 -3.93141420e+10  0.00000000e+00
   0.00000000e+00  1.35244210e+10]]
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
Newton solver: converged after 4 iterations.
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[ 1.78478773e+11  6.63691575e+10  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  1.78478773e+11  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  6.63691575e+10  1.78478773e+11  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.12109616e+11
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.12109616e+11  0.00000000e+00]
 [-3.93141420e+10 -3.93141420e+10 -3.93141420e+10  0.00000000e+00
   0.00000000e+00  1.35244210e+10]]
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
Newton solver: converged after 4 iterations.
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[ 1.78478773e+11  6.63691575e+10  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  1.78478773e+11  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  6.63691575e+10  1.78478773e+11  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.12109616e+11
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.12109616e+11  0.00000000e+00]
 [-3.93141420e+10 -3.93141420e+10 -3.93141420e+10  0.00000000e+00
   0.00000000e+00  1.35244210e+10]]
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
Newton solver: converged after 4 iterations.
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[ 1.78478773e+11  6.63691575e+10  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  1.78478773e+11  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  6.63691575e+10  1.78478773e+11  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.12109616e+11
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.12109616e+11  0.00000000e+00]
 [-3.93141420e+10 -3.93141420e+10 -3.93141420e+10  0.00000000e+00
   0.00000000e+00  1.35244210e+10]]
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
Newton solver: converged after 4 iterations.
6 C: [[2.01923077e+11 8.65384615e+10 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 2.01923077e+11 8.65384615e+10 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [8.65384615e+10 8.65384615e+10 2.01923077e+11 0.00000000e+00
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 1.15384615e+11
  0.00000000e+00 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  1.15384615e+11 0.00000000e+00]
 [0.00000000e+00 0.00000000e+00 0.00000000e+00 0.00000000e+00
  0.00000000e+00 1.15384615e+11]]
6 dsig_ddeps: [[ 1.78478773e+11  6.63691575e+10  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  1.78478773e+11  6.63691575e+10  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 6.63691575e+10  6.63691575e+10  1.78478773e+11  0.00000000e+00
   0.00000000e+00 -3.91265260e+10]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  1.12109616e+11
   0.00000000e+00  0.00000000e+00]
 [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
   1.12109616e+11  0.00000000e+00]
 [-3.93141420e+10 -3.93141420e+10 -3.93141420e+10  0.00000000e+00
   0.00000000e+00  1.35244210e+10]]
</pre></div>
</div>
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">RuntimeError</span><span class="g g-Whitespace">                              </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span> <span class="n">line</span> <span class="mi">67</span>
<span class="g g-Whitespace">     </span><span class="mi">63</span>     <span class="c1">#print(&quot;Current epsilon&quot;)</span>
<span class="g g-Whitespace">     </span><span class="mi">64</span>     <span class="c1">#print( eps[-1]+deps )</span>
<span class="g g-Whitespace">     </span><span class="mi">65</span>     <span class="c1">#print(&quot;deps:&quot;,deps)</span>
<span class="g g-Whitespace">     </span><span class="mi">66</span>     <span class="k">if</span> <span class="n">j</span><span class="o">&gt;</span><span class="mi">30</span><span class="p">:</span>
<span class="ne">---&gt; </span><span class="mi">67</span>         <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="s2">&quot;Too many iterations&quot;</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">68</span> <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s2">&quot;sig_:&quot;</span><span class="p">,</span> <span class="n">sig_</span><span class="p">)</span>
<span class="g g-Whitespace">     </span><span class="mi">69</span> <span class="n">eps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">eps_</span><span class="o">.</span><span class="n">copy</span><span class="p">())</span>

<span class="ne">RuntimeError</span>: Too many iterations
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">tr</span><span class="p">(</span><span class="n">sigma</span><span class="p">)</span><span class="o">/</span><span class="mi">3</span> <span class="k">for</span> <span class="n">sigma</span> <span class="ow">in</span> <span class="n">sig</span><span class="p">],</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mf">1.5</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dev</span><span class="p">(</span><span class="n">sigma</span><span class="p">),</span> <span class="n">dev</span><span class="p">(</span><span class="n">sigma</span><span class="p">)))</span> <span class="k">for</span> <span class="n">sigma</span> <span class="ow">in</span> <span class="n">sig</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">yield_surf</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">pc</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">ft</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">M</span><span class="o">**</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">p</span><span class="o">+</span><span class="n">ft</span><span class="o">*</span><span class="n">pc</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">pc</span><span class="o">-</span><span class="n">p</span><span class="p">))</span>
<span class="k">for</span> <span class="n">pc_</span> <span class="ow">in</span> <span class="n">pc</span><span class="p">:</span>
    <span class="n">P</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">pc_</span><span class="p">,</span> <span class="o">-</span><span class="n">ft</span><span class="o">*</span><span class="n">pc_</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
    <span class="n">ys</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">p</span> <span class="p">:</span> <span class="n">yield_surf</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">pc_</span><span class="p">,</span> <span class="n">M</span><span class="p">,</span> <span class="n">ft</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">P</span><span class="p">,</span> <span class="p">[</span><span class="n">ys</span><span class="p">(</span><span class="n">p</span><span class="p">)</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">P</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eps</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eps1</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sig</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[array([0., 0., 0., 0., 0., 0.]),
 array([-7500000., -7500000., -7500000.,        0.,        0.,        0.]),
 array([-7500000.        , -7500000.        , -7500000.        ,
               0.        ,        0.        ,  3263569.75932253]),
 array([-7500000.        , -7500000.        , -7500000.        ,
               0.        ,        0.        ,  6527139.51864506]),
 array([-7500000.        , -7500000.        , -7500000.        ,
               0.        ,        0.        ,  9790709.27796758]),
 array([-7500000.        , -7500000.        , -7500000.        ,
               0.        ,        0.        , 13054279.03729011]),
 array([-7500000.        , -7500000.        , -7500000.        ,
               0.        ,        0.        , 16317848.79661264])]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sig1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[array([0., 0., 0., 0., 0., 0.]),
 array([-50000., -50000., -50000.,      0.,      0.,      0.]),
 array([-100000., -100000., -100000.,       0.,       0.,       0.]),
 array([-150000., -150000., -150000.,       0.,       0.,       0.]),
 array([-200000., -200000., -200000.,       0.,       0.,       0.]),
 array([-250000., -250000., -250000.,       0.,       0.,       0.]),
 array([-300000., -300000., -300000.,       0.,       0.,       0.]),
 array([-350000., -350000., -350000.,       0.,       0.,       0.]),
 array([-400000., -400000., -400000.,       0.,       0.,       0.]),
 array([-450000., -450000., -450000.,       0.,       0.,       0.]),
 array([-500000., -500000., -500000.,       0.,       0.,       0.]),
 array([-550000., -550000., -550000.,       0.,       0.,       0.]),
 array([-600000., -600000., -600000.,       0.,       0.,       0.]),
 array([-650000., -650000., -650000.,       0.,       0.,       0.]),
 array([-700000., -700000., -700000.,       0.,       0.,       0.]),
 array([-750000., -750000., -750000.,       0.,       0.,       0.]),
 array([-800000., -800000., -800000.,       0.,       0.,       0.]),
 array([-850000., -850000., -850000.,       0.,       0.,       0.]),
 array([-900000., -900000., -900000.,       0.,       0.,       0.]),
 array([-950000., -950000., -950000.,       0.,       0.,       0.]),
 array([-1000000., -1000000., -1000000.,        0.,        0.,        0.]),
 array([-1017532.46753256, -1017532.46753256, -1017532.46753256,
               0.        ,        0.        ,        0.        ]),
 array([-1035263.31767784, -1035263.31767784, -1035263.31767784,
               0.        ,        0.        ,        0.        ]),
 array([-1053192.34469773, -1053192.34469773, -1053192.34469773,
               0.        ,        0.        ,        0.        ]),
 array([-1071319.30376354, -1071319.30376354, -1071319.30376354,
               0.        ,        0.        ,        0.        ]),
 array([-1089643.91164197, -1089643.91164197, -1089643.91164197,
               0.        ,        0.        ,        0.        ]),
 array([-1108165.84740601, -1108165.84740601, -1108165.84740601,
               0.        ,        0.        ,        0.        ]),
 array([-1126884.75316955, -1126884.75316955, -1126884.75316955,
               0.        ,        0.        ,        0.        ]),
 array([-1145800.23484187, -1145800.23484187, -1145800.23484187,
               0.        ,        0.        ,        0.        ]),
 array([-1164911.86290435, -1164911.86290435, -1164911.86290435,
               0.        ,        0.        ,        0.        ]),
 array([-1184219.17320539, -1184219.17320539, -1184219.17320539,
               0.        ,        0.        ,        0.        ])]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eps_el</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[array([-3.e-06, -3.e-06, -3.e-06,  0.e+00,  0.e+00,  0.e+00]),
 array([-6.e-06, -6.e-06, -6.e-06,  0.e+00,  0.e+00,  0.e+00]),
 array([-9.e-06, -9.e-06, -9.e-06,  0.e+00,  0.e+00,  0.e+00]),
 array([-1.2e-05, -1.2e-05, -1.2e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-1.5e-05, -1.5e-05, -1.5e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-1.8e-05, -1.8e-05, -1.8e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-2.1e-05, -2.1e-05, -2.1e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-2.4e-05, -2.4e-05, -2.4e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-2.7e-05, -2.7e-05, -2.7e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-3.e-05, -3.e-05, -3.e-05,  0.e+00,  0.e+00,  0.e+00]),
 array([-3.3e-05, -3.3e-05, -3.3e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-3.6e-05, -3.6e-05, -3.6e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-3.9e-05, -3.9e-05, -3.9e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-4.2e-05, -4.2e-05, -4.2e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-4.5e-05, -4.5e-05, -4.5e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-4.8e-05, -4.8e-05, -4.8e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-5.1e-05, -5.1e-05, -5.1e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-5.4e-05, -5.4e-05, -5.4e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-5.7e-05, -5.7e-05, -5.7e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-6.e-05, -6.e-05, -6.e-05,  0.e+00,  0.e+00,  0.e+00]),
 array([-6.e-05, -6.e-05, -6.e-05,  0.e+00,  0.e+00,  0.e+00]),
 array([-6.10519481e-05, -6.10519481e-05, -6.10519481e-05,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00]),
 array([-6.21157991e-05, -6.21157991e-05, -6.21157991e-05,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00]),
 array([-6.31915408e-05, -6.31915408e-05, -6.31915408e-05,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00]),
 array([-6.42791584e-05, -6.42791584e-05, -6.42791584e-05,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00]),
 array([-6.53786349e-05, -6.53786349e-05, -6.53786349e-05,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00]),
 array([-6.64899511e-05, -6.64899511e-05, -6.64899511e-05,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00]),
 array([-6.76130855e-05, -6.76130855e-05, -6.76130855e-05,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00]),
 array([-6.87480144e-05, -6.87480144e-05, -6.87480144e-05,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00]),
 array([-6.98947121e-05, -6.98947121e-05, -6.98947121e-05,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00]),
 array([-7.10531508e-05, -7.10531508e-05, -7.10531508e-05,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00])]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">eps_el1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[array([0., 0., 0., 0., 0., 0.]),
 array([-3.e-06, -3.e-06, -3.e-06,  0.e+00,  0.e+00,  0.e+00]),
 array([-6.e-06, -6.e-06, -6.e-06,  0.e+00,  0.e+00,  0.e+00]),
 array([-9.e-06, -9.e-06, -9.e-06,  0.e+00,  0.e+00,  0.e+00]),
 array([-1.2e-05, -1.2e-05, -1.2e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-1.5e-05, -1.5e-05, -1.5e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-1.8e-05, -1.8e-05, -1.8e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-2.1e-05, -2.1e-05, -2.1e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-2.4e-05, -2.4e-05, -2.4e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-2.7e-05, -2.7e-05, -2.7e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-3.e-05, -3.e-05, -3.e-05,  0.e+00,  0.e+00,  0.e+00]),
 array([-3.3e-05, -3.3e-05, -3.3e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-3.6e-05, -3.6e-05, -3.6e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-3.9e-05, -3.9e-05, -3.9e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-4.2e-05, -4.2e-05, -4.2e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-4.5e-05, -4.5e-05, -4.5e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-4.8e-05, -4.8e-05, -4.8e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-5.1e-05, -5.1e-05, -5.1e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-5.4e-05, -5.4e-05, -5.4e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-5.7e-05, -5.7e-05, -5.7e-05,  0.0e+00,  0.0e+00,  0.0e+00]),
 array([-6.e-05, -6.e-05, -6.e-05,  0.e+00,  0.e+00,  0.e+00]),
 array([-6.10519481e-05, -6.10519481e-05, -6.10519481e-05,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00]),
 array([-6.21157991e-05, -6.21157991e-05, -6.21157991e-05,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00]),
 array([-6.31915407e-05, -6.31915407e-05, -6.31915407e-05,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00]),
 array([-6.42791582e-05, -6.42791582e-05, -6.42791582e-05,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00]),
 array([-6.53786347e-05, -6.53786347e-05, -6.53786347e-05,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00]),
 array([-6.64899508e-05, -6.64899508e-05, -6.64899508e-05,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00]),
 array([-6.76130852e-05, -6.76130852e-05, -6.76130852e-05,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00]),
 array([-6.87480141e-05, -6.87480141e-05, -6.87480141e-05,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00]),
 array([-6.98947118e-05, -6.98947118e-05, -6.98947118e-05,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00]),
 array([-7.10531504e-05, -7.10531504e-05, -7.10531504e-05,  0.00000000e+00,
         0.00000000e+00,  0.00000000e+00])]
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./numerical_ex"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stress-strain-hybrid-control">Stress - strain hybrid control</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Maxime PIERRE
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>